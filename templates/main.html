{% from "_formhelpers.html" import render_input_bool %}
{% from "_formhelpers.html" import render_input_text %}
{% from "_formhelpers.html" import render_input_number %}

{% extends "layout.html" %}
{% block body %}

  <h2>Crawlers</h2>
  <form action="{{ url_for('.new_crawler') }}" method="post">
    <button type="submit">Add new crawler</button>
  </form>
  <form action="/crawler-update" method="post">
    <table class="sortable">
      <tr>
        <th>Active</th>
        <th>Name</th>
        <th>Run cadence</th>
        <th>Last run</th>
        <th>Delete</th>
      </tr>

        {% for crawler in crawlers %}
          <tr>
            <td>{{render_input_bool(crawler.crawlerid, 'active', crawler.active)}}</td>
            <td>{{render_input_text(crawler.crawlerid, 'name', crawler.name)}}</td>
            <td>{{render_input_number(crawler.crawlerid, 'runcadence', crawler.runcadence)}}</td>
            <td>{{crawler.lastrun}}</td>
            <td><input type="submit" name="{{ crawler.crawlerid }}_{{ delete }}" value="Delete"></td>
            <input type="text" name="{{ crawler.crawlerid }}_{{ dummy }}" value="dummy" hidden="true"/>
          </tr>
        {% endfor %}
    </table>
    <button type="submit">Save</button>
  </form>

  <h2>Matches</h2>
  <form action="/match-update" method="post">
    <table class="sortable">
      <tr>
        <th>Hide</th>
        <th>Image</th>
        <th>Title</th>
        <th>Price</th>
        <th>Location</th>
        <th>Seller</th>
      </tr>

        {% for match in matches %}
          <tr>
            <td>{{render_input_bool(match.matchid, 'hide', match.hide)}}</td>
            <td><img src="/static{{match.image}}" loading="lazy" alt="..." width="150"></td>
            <td><a href="{{match.url}}">{{match.title}}</a></td>
            <td>{{match.price}}</td>
            <td>{{match.location}}</td>
            <td>{{match.seller}}</td>
            <input type="text" name="{{ match.matchid }}_{{ dummy }}" value="dummy" hidden="true"/>
          </tr>
        {% endfor %}
    </table>
    <button type="submit">Save</button>
  </form>

{% endblock %}